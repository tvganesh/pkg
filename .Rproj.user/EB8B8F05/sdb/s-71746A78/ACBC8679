{
    "contents" : "##########################################################################################\n# Designed and developed by Tinniam V Ganesh\n# Date : 2 Jul 2015\n# Function: batsmanRunsLikelihood\n# This function used K-Means to compute and plot the runs likelihood for the batsman\n#\n###########################################################################################\n\nbatsmanRunsLikelihood <- function(file, name=\"A Squarecut\") {\n\n   Runs <- BF <-Mins <- Ground <-Wkts <- NULL\n   batsman <- clean(file)\n   data <- select(batsman,Runs,BF,Mins)\n\n   # Use K Means with 3 clusters\n   fit <- kmeans(data, 3)\n   str <- paste(name,\"'s Runs likelihood vs BF, Mins\")\n   # Create a 3D scatterplot\n   s <-scatterplot3d(data$BF,data$Mins,data$Runs,color=\"lightblue\",main=str,pch=20,\n                     xlab=\"Balls Faced\",ylab=\"Minutes at crease\",zlab=\"Runs scored\")\n   \n   # Plot the centroids\n   s$points3d(fit$centers[1,2],fit$centers[1,3],fit$centers[1,1],col=\"blue\",type=\"h\", pch=15,lwd=4)\n   s$points3d(fit$centers[2,2],fit$centers[2,3],fit$centers[2,1],col=\"red\",type=\"h\", pch=15,lwd=4)\n   s$points3d(fit$centers[3,2],fit$centers[3,3],fit$centers[3,1],col=\"black\",type=\"h\", pch=15,lwd=4)\n   mtext(\"Data source-Courtesy:ESPN Cricinfo\", side=1, line=4, adj=1.0, cex=0.8, col=\"blue\")\n   \n   p1 <- (sum(fit$cluster==1)/length(fit$cluster)) * 100\n   p2 <- (sum(fit$cluster==2)/length(fit$cluster)) * 100\n   p3 <- (sum(fit$cluster==3)/length(fit$cluster)) * 100\n   \n   # Print the summary of the centroids\n   \n   cat(\"Summary of \",name,\"'s runs scoring likelihood\\n\")\n   cat(\"**************************************************\\n\\n\")\n   cat(\"There is a\",round(p1,2), \"% likelihood that\",name,\" will make \",round(fit$centers[1,1]),\n              \"Runs in \",round(fit$centers[1,2]),\"balls over\",round(fit$centers[1,3]),\" Minutes \\n\")\n   \n   cat(\"There is a\",round(p2,2), \"% likelihood that\",name,\" will make \",round(fit$centers[2,1]),\n       \"Runs in \",round(fit$centers[2,2]),\"balls over \",round(fit$centers[2,3]),\" Minutes \\n\")\n   \n   cat(\"There is a\",round(p3,2), \"% likelihood that\",name,\" will make \",round(fit$centers[3,1]),\n       \"Runs in \",round(fit$centers[3,2]),\"balls over\",round(fit$centers[3,3]),\" Minutes \\n\")\n   \n}\n",
    "created" : 1451058167217.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1830337388",
    "id" : "ACBC8679",
    "lastKnownWriteTime" : 1451058199,
    "path" : "C:/software/cricket-package/git/cricketr/cricketr/R/batsmanRunsLikelihood.R",
    "project_path" : "R/batsmanRunsLikelihood.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}